//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
//
//     RTGen (DelphiGenerator v4.0.1) on 08.03.2024 14:43:40.
// </auto-generated>
//------------------------------------------------------------------------------
unit OpenDAQ.Updatable;

interface
uses
  OpenDAQ.CoreTypes,
  OpenDAQ.ObjectPtr,
  OpenDAQ.ProxyValue,
  OpenDAQ.SerializedObject,
  OpenDAQ.Serializer;

type
  {$MINENUMSIZE 4}

  IUpdatablePtr = interface(IObjectPtr<IUpdatable>)
  ['{18c188b4-27db-5d5e-a32a-538ebbbb5854}']
    procedure Update(Update: ISerializedObject); overload;
    procedure Update(Update: ISerializedObjectPtr); overload;

    procedure SerializeForUpdate(Serializer: ISerializer); overload;
    procedure SerializeForUpdate(Serializer: ISerializerPtr); overload;

    procedure UpdateEnded();
  end;

  TUpdatablePtr = class(TObjectPtr<IUpdatable>, IUpdatablePtr, IUpdatable)
  public
    constructor Create(Obj: IBaseObject); overload; override;
    constructor Create(Obj: IUpdatable); overload;

    procedure Update(Update: ISerializedObject); overload;
    procedure Update(Update: ISerializedObjectPtr); overload;

    procedure SerializeForUpdate(Serializer: ISerializer); overload;
    procedure SerializeForUpdate(Serializer: ISerializerPtr); overload;

    procedure UpdateEnded();
  private
    function IUpdatable.Update = Interface_Update;
    function IUpdatable.SerializeForUpdate = Interface_SerializeForUpdate;
    function IUpdatable.UpdateEnded = Interface_UpdateEnded;

    function Interface_Update(Update: ISerializedObject): ErrCode; stdcall;
    function Interface_SerializeForUpdate(Serializer: ISerializer): ErrCode; stdcall;
    function Interface_UpdateEnded(): ErrCode; stdcall;
  end;


implementation
uses
  OpenDAQ.CoreTypes.Errors,
  OpenDAQ.Exceptions,
  OpenDAQ.SmartPtrRegistry;


constructor TUpdatablePtr.Create(Obj: IUpdatable);
begin
  inherited Create(Obj);
end;

constructor TUpdatablePtr.Create(Obj: IBaseObject);
begin
  inherited Create(Obj);
end;

procedure TUpdatablePtr.Update(Update: ISerializedObject);
var
  Err: ErrCode;
begin
  if not Assigned(FObject) then
    raise ERTInvalidParameterException.Create('Interface object is nil.');

  Err := FObject.Update(Update);
  CheckRtErrorInfo(Err);
end;

procedure TUpdatablePtr.Update(Update: ISerializedObjectPtr);
var
  Err: ErrCode;
  UpdateIntf: ISerializedObject;
begin
  if not Assigned(FObject) then
    raise ERTInvalidParameterException.Create('Interface object is nil.');

  if Assigned(Update) then
    UpdateIntf := Update.GetInterface()
  else
    UpdateIntf := nil;

  Err := FObject.Update(UpdateIntf);
  CheckRtErrorInfo(Err);
end;

procedure TUpdatablePtr.SerializeForUpdate(Serializer: ISerializer);
var
  Err: ErrCode;
begin
  if not Assigned(FObject) then
    raise ERTInvalidParameterException.Create('Interface object is nil.');

  Err := FObject.SerializeForUpdate(Serializer);
  CheckRtErrorInfo(Err);
end;

procedure TUpdatablePtr.SerializeForUpdate(Serializer: ISerializerPtr);
var
  Err: ErrCode;
  SerializerIntf: ISerializer;
begin
  if not Assigned(FObject) then
    raise ERTInvalidParameterException.Create('Interface object is nil.');

  if Assigned(Serializer) then
    SerializerIntf := Serializer.GetInterface()
  else
    SerializerIntf := nil;

  Err := FObject.SerializeForUpdate(SerializerIntf);
  CheckRtErrorInfo(Err);
end;

procedure TUpdatablePtr.UpdateEnded();
var
  Err: ErrCode;
begin
  if not Assigned(FObject) then
    raise ERTInvalidParameterException.Create('Interface object is nil.');

  Err := FObject.UpdateEnded();
  CheckRtErrorInfo(Err);
end;

function TUpdatablePtr.Interface_Update(Update: ISerializedObject): ErrCode; stdcall;
begin
  Result := FObject.Update(Update);
end;

function TUpdatablePtr.Interface_SerializeForUpdate(Serializer: ISerializer): ErrCode; stdcall;
begin
  Result := FObject.SerializeForUpdate(Serializer);
end;

function TUpdatablePtr.Interface_UpdateEnded(): ErrCode; stdcall;
begin
  Result := FObject.UpdateEnded();
end;

initialization
  TSmartPtrRegistry.RegisterPtr(IUpdatable, IUpdatablePtr, TUpdatablePtr);

finalization
  TSmartPtrRegistry.UnregisterPtr(IUpdatable);

end.
